<h2>Titolo: <%= @property.titolo %></h2>
<p>Descrizione: <%= @property.descrizione %></p>
<p>Prezzo: <%= @property.prezzo %>€</p>
<p>Valutazione: <%= @property.valutation %></p>
<p>Città: <%= @property.city %></p>
<p>Inserzione di:
<% if @property.user.provider == nil %>
    <%= @property.user.username %></p>
<% else %>
    <%= @property.user.name %></p>
<% end %>

<% if @property.img1.present? %>
  <%= image_tag @property.img1.url(:medium) %>
<% end %>

<% if @property.img2.present? %>
  <%= image_tag @property.img2.url(:medium) %>
<% end %>

<% if @property.img3.present? %>
  <%= image_tag @property.img3.url(:medium) %>
<% end %>

<p><%= mail_to @property.user.email, "Vuoi prenotare? Contatta l'utente", subject: @property.titolo %></p>

<p><a class="twitter-share-button"
  href="https://twitter.com/share"
  data-size="large"
  data-text="Guarda questo locale: "
  data-url="https://dev.twitter.com/web/tweet-button"
  data-hashtags="example,demo"
  data-via="twitterdev"
  data-related="twitterapi,twitter">
  <img src="http://tweetforprofits.com/UltraVid/images/share-twitter.png" style="width:210px;height:45px;">
</a></p>

<p>
<% if current_user != @property.user %>
  <%= link_to "Vedi altro dall'utente", summary_path(@property), method: :get %>
<% end %>
</p>

<p><% if @property.user == current_user %>
	<%= link_to "Modifica", edit_property_path(@property) %>
	<%= link_to "Elimina", property_path(@property),
			method: :delete,
		        data: {confirm: 'Are you sure?'},
			:class => 'btn btn-danger' %>
<% end %></p>

<!-- ##########RECENSIONI########## -->

<hr><h2>Recensioni</h2>
<% @property.reviews.each do |review| %>

  <p>
    <% if current_user.provider == nil %>
      <h2><%= review.user.username %></h2>
      <%= image_tag review.user.avatar.url(:small) %>
    <% else %>
      <h2><%= review.user.name %></h2>
      <%= image_tag review.user.image %>
    <% end %>
    <br>
    Titolo: <%= review.title %>
    <br><br>
    Descrizione:
    <p><%= review.body %></p>
    Valutazione: <%= review.valutation %>
  </p>
  <% if current_user == review.user %>
    <%= link_to 'Elimina', [review.property, review],
            method: :delete,
            data: { confirm: 'Sei sicuro?' } %>
  <% end %>
<% end %>

<br><br>

<% if current_user != nil %>
  <h2>Scrivi una recensione:</h2>
  <%= form_for([@property, @property.reviews.build]) do |f| %>
    <p>
      <%= f.label :title %>
      <%= f.text_field :title %>
    </p>
    <p>
      <%= f.label :body %><br>
      <%= f.text_area :body %>
    </p>
    <p>
      Valutazione: <%= f.select :valutation, ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10']%>
    </p>
    <p>
      <%= f.submit "Invia" %>
    </p>
  <% end %>
<% end %>

<!-- ##########DOMANDE########## -->

<hr><h2>Domande</h2>
<% @property.questions.each do |question| %>
  <p>
    <strong>• </strong>
      <% if question.user.provider == nil %>
        <%= question.user.username %>
    <% else %>
        <%= question.user.name %>
    <% end %>
    <br>
    <strong>- </strong><%= question.body %>
    <br>
    <%= link_to 'Vedi risposte', property_question_path(question) %>
    <% if current_user == question.user %>
      <%= link_to 'Elimina', [question.property, question],
               method: :delete,
               data: { confirm: 'Sei sicuro?' } %>
    <% end %>
  </p>
<% end %>

<% if current_user != nil %>
  <h2>Fai una domanda:</h2>
  <%= form_for([@property, @property.questions.build]) do |f| %>
    <p>
      <%= f.text_area :body %>
    </p>
    <p>
      <%= f.submit "Invia" %>
    </p>
  <% end %>
<% end %>

<hr><h3>Link utili:</h3>

<% if current_user != nil %>
	<% if current_user.favourites.exists?(@property.id) %>
		<%= link_to "Rimuovi dai preferiti", remove_from_f_property_path(@property), method: :post %><p/>
	<% else %>
		<%= link_to "Aggiungi ai preferiti", add_to_f_property_path(@property), method: :post %><p/>
	<% end %>

	<% if current_user.followings.exists?(@property.user.id) %>
		<%= link_to "Unfollow utente", unfollow_path(@property), method: :post %><p/>
	<% else %>
		<%= link_to "Follow utente", follow_path(@property), method: :post %><p/>
	<% end %>
<% end %>
